<!DOCTYPE html>
<html>
    <head>
        <title>RVM : Configuring the RVM</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">RVM</a></span>
                            </li>
                                                    <li>
                                <span><a href="User-Guide_73933.html">User Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="Care-and-Feeding_73910.html">Care and Feeding</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            RVM : Configuring the RVM
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
    
            Created by <span class='author'> Peter Donald</span>, last modified by <span class='editor'> Erik Brangs</span> on Jan 24, 2015
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>The build process requires a number of build time parameters that specify the features and components for a Jikes RVM build. Typically the build parameters are defined within a property file located in the <a href="http://hg.code.sourceforge.net/p/jikesrvm/code/file/tip/build/configs" class="external-link" rel="nofollow">build/configs</a> directory. The following table defines the parameters for the build configuration.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property</p></th><th class="confluenceTh"><p>Description</p></th><th class="confluenceTh"><p>Default</p></th></tr><tr><td class="confluenceTd"><p>config.name</p></td><td class="confluenceTd"><p>A unique name that identifies the set of build parameters.</p></td><td class="confluenceTd"><p>None</p></td></tr><tr><td class="confluenceTd"><p>config.bootimage.compiler</p></td><td class="confluenceTd"><p>Parameter selects the compiler used when creating the bootimage. Must be either <em>opt</em> or <em>base</em>.</p></td><td class="confluenceTd"><p>base</p></td></tr><tr><td class="confluenceTd"><p>config.bootimage.compiler.args</p></td><td class="confluenceTd"><p>Parameter specifies any extra args that are passed to the bootimage compiler.</p></td><td class="confluenceTd"><p>&quot;&quot;</p></td></tr><tr><td class="confluenceTd"><p>config.runtime.compiler</p></td><td class="confluenceTd"><p>Parameter selects the compiler used at runtime. Must be either <em>opt</em> or <em>base</em>.</p></td><td class="confluenceTd"><p>base</p></td></tr><tr><td class="confluenceTd"><p>config.include.aos</p></td><td class="confluenceTd"><p>Include the adaptive system if set to true. Parameter will be ignored if config.runtime.compiler is not <em>opt</em>.</p></td><td class="confluenceTd"><p>false</p></td></tr><tr><td class="confluenceTd"><p>config.mmtk.plan</p></td><td class="confluenceTd"><p>The name of the GC plan to use for the build. See <a href="MMTk_73767.html">MMTk</a> for more details.</p></td><td class="confluenceTd"><p>None</p></td></tr><tr><td class="confluenceTd"><p>config.default-heapsize.initial</p></td><td class="confluenceTd"><p>Parameter specifying the default initial heap size in MB.</p></td><td class="confluenceTd"><p>20</p></td></tr><tr><td class="confluenceTd"><p>config.default-heapsize.maximum</p></td><td class="confluenceTd"><p>Parameter specifying the default maximum heap size in MB.</p></td><td class="confluenceTd"><p>100</p></td></tr><tr><td class="confluenceTd"><p>config.assertions</p></td><td class="confluenceTd"><p>Parameter specifies the level of assertions in the code base. Must be one of <em>extreme</em>, <em>normal</em> or <em>none</em>.</p></td><td class="confluenceTd"><p>normal</p></td></tr><tr><td class="confluenceTd"><p>config.stress-gc-interval</p></td><td class="confluenceTd"><p>The build will stress test the gc subsytem if set to a positive value. The value indicates the number of allocations between collections</p></td><td class="confluenceTd"><p>0</p></td></tr><tr><td class="confluenceTd"><p>config.include.perfevent</p></td><td class="confluenceTd"><p>Set to true to build Jikes RVM with support for performance counters.</p></td><td class="confluenceTd"><p>false</p></td></tr><tr><td class="confluenceTd"><p>config.include.gcspy</p></td><td class="confluenceTd"><p>Set to true to build Jikes RVM with GCSpy support. See <a href="Using-GCSpy_73247.html">Using GCSpy</a> for more details.</p></td><td class="confluenceTd"><p>false</p></td></tr><tr><td class="confluenceTd"><p>config.include.gcspy-client</p></td><td class="confluenceTd"><p>Set to true to bundle the GCSpy client with the Jikes RVM build. Parameter will be ignored if config.include.gcspy is not <em>true</em>.</p></td><td class="confluenceTd"><p>false</p></td></tr><tr><td class="confluenceTd"><p>config.include.gcspy-stub</p></td><td class="confluenceTd"><p>Set to true to use the GCSpy stub rather than the real GCSpy component. Parameter will be ignored if config.include.gcspy is not <em>true</em>.</p></td><td class="confluenceTd"><p>false</p></td></tr><tr><td class="confluenceTd"><p>config.include.all-classes</p></td><td class="confluenceTd"><p>Include all the Jikes RVM classes in the bootimage if set to true.</p></td><td class="confluenceTd"><p>false</p></td></tr></tbody></table></div><h2 id="ConfiguringtheRVM-JikesRVMConfigurations">Jikes RVM Configurations</h2><p>A typical user will use one of the existing build configurations and thus the build system only requires that the user specify the config.name property. The name should match one of the files located in the build/configs/ directory minus the '<code>.properties</code>' extension.</p><h3 id="ConfiguringtheRVM-LogicalConfigurations">Logical Configurations</h3><p>There are many possible Jikes RVM configurations. Therefore, we define four &quot;logical&quot; configurations that are most suitable for casual or novice users of the system. The four configurations are:</p><ul><li><strong>prototype:</strong> A simple, fast to build, but low performance configuration of Jikes RVM. This configuration does not include the optimizing compiler or adaptive system. Most useful for rapid prototyping of the core virtual machine.</li><li><strong>prototype-opt:</strong> A simple, fast to build, but low performance configuration of Jikes RVM. Unlike prototype, this configuration does include the optimizing compiler and adaptive system. Most useful for rapid prototyping of the core virtual machine, adaptive system, and optimizing compiler.</li><li><strong>development:</strong> A fully functional configuration of Jikes RVM with reasonable performance that includes the adaptive system and optimizing compiler. This configuration takes longer to build than the two prototype configurations.</li><li><strong>production:</strong> The same as the development configuration, except all assertions are disabled. This is the highest performance configuration of Jikes RVM and is the one to use for benchmarking and performance analysis. Build times are similar to the development configuration.</li></ul><p>The mapping of logical to actual configurations may vary from release to release. In particular, it is expected that the choice of garbage collector for these logical configurations may be different as MMTk evolves.</p><p>Logical configurations that are not mentioned here are not recommended for novice users of the system.</p><h3 id="ConfiguringtheRVM-ConfigurationsinDepth">Configurations in Depth</h3><p>Most standard Jikes RVM configuration files follow the following naming scheme:</p><p><em>[ExtremeAssertions]</em> <strong>(Base | Full | Fast) (<code>Base</code> | <code>Adaptive) </code></strong><em>&lt;garbage collector&gt;</em><br /> where</p><ul><li><em>ExtremeAssertions</em> is optional. Its presence indicates that the <code>config.assertions</code> configuration parameter is set to <code>extreme</code>. This turns on a number of expensive assertions.</li><li><strong>Base | Full | Fast</strong> determines the performance of the Jikes RVM boot image. <strong>Base</strong> denotes baseline compiler and enabled assertions, <strong>Full</strong> denotes optimizing compiler and enabled assertions, <strong>Fast</strong> denotes optimizing compiler and disabled assertions. Note that <strong>Fast</strong> is exclusive with <em>ExtremeAssertions</em> and that <strong>Full</strong> and <strong>Fast</strong> imply that adaptive system and optimizing compiler are included in the image.</li><li><strong><code>Base</code><em> |</em> <code>Adaptive</code> </strong>denotes whether or not the adaptive system and optimizing compiler are included in the build.</li><li>the <em>garbage collector</em> is the garbage collection scheme used.</li></ul><p>Each version of Jikes RVM provides several garbage collector choices. For a definitive list of garbage collector choices, please refer to the configurations that are shipped with your version of Jikes RVM. If you need a configuration that is not available by default, you can just define your own based on the existing ones (it's easy!).</p><p>Some garbage collector suffixes that may be available are:</p><ul><li>&quot;NoGC&quot; no garbage collection is performed.</li><li>&quot;SemiSpace&quot; a copying semi-space collector.</li><li>&quot;MarkSweep&quot; a mark-and-sweep (non copying) collector</li><li>&quot;GenCopy&quot; a classic copying generational collector with a copying higher generation</li><li>&quot;GenMS&quot; a copying generational collector with a non-copying mark-and-sweep mature space</li><li>&quot;CopyMS&quot; a hybrid non-generational collector with a copying space (into which all allocation goes), and a non-copying space into which survivors go.</li><li>&quot;RefCount&quot; a reference counting collector with synchronous (non-concurrent) cycle collection</li></ul><p>For example, to specify a Jikes RVM configuration:</p><ol><li>with a baseline-compiled boot image,</li><li>that will compile classes loaded at runtime using the baseline compiler and</li><li>that uses a non-generational semi-space copying garbage collector,</li></ol><p>use the name <strong>&quot;<code>BaseBaseSemiSpace</code>&quot;</strong>.</p><p>In configurations that include the adaptive system (denoted by <strong>&quot;<code>Adaptive</code>&quot;</strong> in their name), methods are initially compiled by one compiler (by default the baseline compiler) and then online profiling is used to automatically select hot methods for recompilation by the optimizing compiler at an appropriate optimization level.</p><p>For example, to a build for an adaptive configuration with assertions, where the optimizing compiler is used to compile the boot image and the semi-space garbage collector is used, use the following command:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>% ant -Dconfig.name=FullAdaptiveSemiSpace</pre>
</div></div><h3 id="ConfiguringtheRVM-Exampleconfigurationsandtheiruses">Example configurations and their uses</h3><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">configuration</th><th class="confluenceTh">description</th><th class="confluenceTh">potential uses</th></tr><tr><td class="confluenceTd">BaseBaseSomeGC</td><td class="confluenceTd"><p>baseline compiled bootimage with assertions,</p><p>baseline compiler at runtime</p></td><td class="confluenceTd"><p>prototyping; debugging of garbage collector SomeGC without having to worry</p><p>about complexities introduced by compiler optimizations; checking for</p><p>problems related to <a href="Uninterruptible-Code_74057.html">uninterruptible code</a></p></td></tr><tr><td class="confluenceTd">BaseAdaptiveSomeGC</td><td class="confluenceTd"><p>baseline compiled bootimage with assertions,</p><p>baseline compiler, adaptive system and</p><p>optimizing compiler at runtime</p></td><td class="confluenceTd"><p>prototyping that includes optimizing compiler and adaptive system;</p><p>debugging of optimizing compiler problems with compiler advice;</p><p>sanity checks with comparatively short benchmarks;</p><p>checking for problems related to <a href="Uninterruptible-Code_74057.html">uninterruptible code</a></p></td></tr><tr><td class="confluenceTd">FullAdaptiveSomeGC</td><td class="confluenceTd"><p>bootimage compiled with optimizing compiler</p><p>and assertions; everything available at runtime</p></td><td class="confluenceTd"><p>extensive testing including long-running benchmarks; checking for</p><p>incorrect usage of <a href="Unboxed-Types_74052.html">unboxed types</a></p></td></tr><tr><td class="confluenceTd">ExtremeAssertions*</td><td class="confluenceTd"><p>enables all generally useful assertions, including</p><p>very expensive ones</p></td><td class="confluenceTd">debugging and testing in special cases</td></tr><tr><td class="confluenceTd">FastAdaptiveSomeGC</td><td class="confluenceTd"><p>bootimage compiled with optimizing compiler;</p><p>assertions disabled; everything available at runtime</p></td><td class="confluenceTd">benchmarking</td></tr><tr><td class="confluenceTd">FullBaseSomeGC</td><td class="confluenceTd">INVALID - Full implies Adaptive</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">FastBaseSomeGC</td><td class="confluenceTd">INVALID - Fast implies Adaptive</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">ExtremeAssertionsFastAdaptiveSomeGC</td><td class="confluenceTd"><p>INVALID - ExtremeAssertions is incompatible</p><p>with Fast</p></td><td class="confluenceTd"> </td></tr></tbody></table></div><h3 id="ConfiguringtheRVM-Examplemappingoflogicalconfigurationstoactualconfigurations">Example mapping of logical configurations to actual configurations</h3><p>In Jikes RVM 3.1.3, the mapping between logical configurations and actual configurations is:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Logical configuration</th><th class="confluenceTh">Actual configuration</th></tr><tr><td class="confluenceTd">prototype</td><td class="confluenceTd">BaseBaseGenImmix</td></tr><tr><td class="confluenceTd">prototype-opt</td><td class="confluenceTd"><p>BaseAdaptiveGenImmix</p></td></tr><tr><td class="confluenceTd">development</td><td class="confluenceTd">FullAdaptiveGenImmix</td></tr><tr><td class="confluenceTd">production</td><td class="confluenceTd">FastAdaptiveGenImmix</td></tr></tbody></table></div>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Mar 30, 2015 16:28</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
