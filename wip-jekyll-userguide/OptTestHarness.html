---
layout: default-userguide
---
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>OptTestHarness</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,2 --> 
<meta name="src" content="index.tex"> 
<meta name="date" content="2015-06-13 12:58:00"> 
<link rel="stylesheet" type="text/css" href="index.css"> 
</head><body 
>
<!--l. 2--><div class="crosslinks"><p class="noindent">[<a 
href="CostBenefitModel.html" >next</a>] [<a 
href="RawMemoryAccess.html" >prev</a>] [<a 
href="RawMemoryAccess.html#tailRawMemoryAccess.html" >prev-tail</a>] [<a 
href="#tailOptTestHarness.html">tail</a>] [<a 
href="index.html#OptTestHarness.html" >up</a>] </p></div>
<h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x4-30003"></a>OptTestHarness</h3>
<!--l. 4--><p class="noindent" >For optimizing compiler development, it is sometimes useful to exercise careful
control over which classes are compiled, and with which optimization level. In many
cases, a prototype-opt image will suit this process using the command line option
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">-X:aos:initial_compiler=opt</span></span></span> combined with <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">-X:aos:enable_recompilation=false</span></span></span>.
This configuration invokes the optimizing compiler on each method run.The
<span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">org.jikesrvm.tools.oth.OptTestHarness</span><span 
class="cmtt-10">&#x00A0;program</span></span></span> provides even more
control over the optimizing compiler. This driver program allows you to
invoke the optimizing compiler as an &#8221;application&#8221; running on top of the
VM.
<div class="table">
                                                                  

                                                                  
<!--l. 7--><p class="noindent" ><a 
 id="x4-30011"></a><hr class="float"><div class="float" 
>
                                                                  

                                                                  
<div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1"><col 
id="TBL-2-2"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-1"  
class="td11"><!--l. 8--><p class="noindent" >-useBootOptions                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-2"  
class="td11"><!--l. 8--><p class="noindent" >Use  the  same  OptOptions  as  the
bootimage compiler.                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-2-1"  
class="td11"><!--l. 9--><p class="noindent" >-longcommandline <span 
class="cmmi-10">&#x003C;</span>filename<span 
class="cmmi-10">&#x003E;</span>        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-2-2"  
class="td11"><!--l. 9--><p class="noindent" >Read commands (one per line) from
a file                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-3-1"  
class="td11"><!--l. 10--><p class="noindent" >+baseline                                     </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-3-2"  
class="td11"><!--l. 10--><p class="noindent" >Switch default compiler to baseline   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-4-1"  
class="td11"><!--l. 11--><p class="noindent" >-baseline                                      </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-4-2"  
class="td11"><!--l. 11--><p class="noindent" >Switch default compiler to optimizing</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-5-1"  
class="td11"><!--l. 12--><p class="noindent" >-load <span 
class="cmmi-10">&#x003C;</span>class<span 
class="cmmi-10">&#x003E;</span>                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-5-2"  
class="td11"><!--l. 12--><p class="noindent" >Load a class                                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-6-1"  
class="td11"><!--l. 13--><p class="noindent" >-class <span 
class="cmmi-10">&#x003C;</span>class<span 
class="cmmi-10">&#x003E;</span>                          </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-6-2"  
class="td11"><!--l. 13--><p class="noindent" >Load  a  class  and  compile  all  its
methods                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-7-1"  
class="td11"><!--l. 14--><p class="noindent" >-method    <span 
class="cmmi-10">&#x003C;</span>class<span 
class="cmmi-10">&#x003E;&#x003C;</span>method<span 
class="cmmi-10">&#x003E;</span>[-    or
<span 
class="cmmi-10">&#x003C;</span>descrip<span 
class="cmmi-10">&#x003E;</span>]                                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-7-2"  
class="td11"><!--l. 14--><p class="noindent" >Compile    method    with    default
compiler                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-8-1"  
class="td11"><!--l. 15--><p class="noindent" >-methodOpt <span 
class="cmmi-10">&#x003C;</span>class<span 
class="cmmi-10">&#x003E;&#x003C;</span>method<span 
class="cmmi-10">&#x003E;</span>[- or
<span 
class="cmmi-10">&#x003C;</span>descrip<span 
class="cmmi-10">&#x003E;</span>]                                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-8-2"  
class="td11"><!--l. 15--><p class="noindent" >Compile method with opt compiler   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-9-1"  
class="td11"><!--l. 16--><p class="noindent" >-methodBase <span 
class="cmmi-10">&#x003C;</span>class<span 
class="cmmi-10">&#x003E;&#x003C;</span>method<span 
class="cmmi-10">&#x003E;</span>[- or
<span 
class="cmmi-10">&#x003C;</span>descrip<span 
class="cmmi-10">&#x003E;</span>]                                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-9-2"  
class="td11"><!--l. 16--><p class="noindent" >Compile method with base compiler </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-10-1"  
class="td11"><!--l. 17--><p class="noindent" >-er        <span 
class="cmmi-10">&#x003C;</span>class<span 
class="cmmi-10">&#x003E;&#x003C;</span>method<span 
class="cmmi-10">&#x003E;</span>[-        or
<span 
class="cmmi-10">&#x003C;</span>descrip<span 
class="cmmi-10">&#x003E;</span>] <span 
class="cmsy-10">{</span>args<span 
class="cmsy-10">}</span>           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-10-2"  
class="td11"><!--l. 17--><p class="noindent" >Compile  with  default  compiler  and
execute a method                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-11-1"  
class="td11"><!--l. 18--><p class="noindent" >-performance                                </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-11-2"  
class="td11"><!--l. 18--><p class="noindent" >Show performance results               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-12-1"  
class="td11"><!--l. 19--><p class="noindent" >-oc                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-12-2"  
class="td11"><!--l. 19--><p class="noindent" >pass  an  option  to  the  optimizing
compiler                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-13-1"  
class="td11">                                </td></tr></table></div>
<br /> <div class="caption" 
><span class="id">Table&#x00A0;1: </span><span  
class="content">OptTestHarness command line options</span></div><!--tex4ht:label?: x4-30011 -->
                                                                  

                                                                  
</div><hr class="endfloat" />
</div>
<h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x4-40003.1"></a>Examples</h4>
<!--l. 28--><p class="noindent" >To use the OptTestHarness program:
<!--l. 30-->
<div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x4-4001r1"></a></span>rvm&#x00A0;org.jikesrvm.tools.oth.OptTestHarness&#x00A0;<span 
class="cmsy-10">-</span>class&#x00A0;Foo
</div>
<!--l. 34--><p class="noindent" >will invoke the optimizing compiler on all methods of class <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">Foo</span></span></span>.
<!--l. 36-->
<div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x4-4002r1"></a></span>rvm&#x00A0;org.jikesrvm.tools.oth.OptTestHarness&#x00A0;<span 
class="cmsy-10">-</span>method&#x00A0;Foo&#x00A0;bar&#x00A0;<span 
class="cmsy-10">-</span>
</div>
<!--l. 40--><p class="noindent" >will invoke the optimizing compiler on the first method bar of class <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">Foo</span></span></span> it
loads.
<!--l. 42-->
<div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x4-4003r1"></a></span>rvm&#x00A0;org.jikesrvm.tools.oth.OptTestHarness&#x00A0;<span 
class="cmsy-10">-</span>method&#x00A0;Foo&#x00A0;bar&#x00A0;&#8217;(I)V;&#8217;
</div>
<!--l. 46--><p class="noindent" >will invoke the optimizing compiler on method <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">Foo.bar(I)V;</span></span></span>. You can specify any
number of -method and -class options on the command line. Any arguments passed
to OptTestHarness via -oc will be passed on directly to the optimizing compiler.
So:
<!--l. 49-->
<div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x4-4004r1"></a></span>rvm&#x00A0;org.jikesrvm.tools.oth.OptTestHarness&#x00A0;<span 
class="cmsy-10">-</span>oc:O1&#x00A0;<span 
class="cmsy-10">-</span>oc:print_final_hir=true&#x00A0;<span 
class="cmsy-10">-</span>method&#x00A0;Foo&#x00A0;bar&#x00A0;<span 
class="cmsy-10">-</span>
</div>
<!--l. 53--><p class="noindent" >will compile <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">Foo.bar</span></span></span> at optimization level O1 and print the final HIR.
                                                                  

                                                                  
<!--l. 2--><div class="crosslinks"><p class="noindent">[<a 
href="CostBenefitModel.html" >next</a>] [<a 
href="RawMemoryAccess.html" >prev</a>] [<a 
href="RawMemoryAccess.html#tailRawMemoryAccess.html" >prev-tail</a>] [<a 
href="OptTestHarness.html" >front</a>] [<a 
href="index.html#OptTestHarness.html" >up</a>] </p></div>
<!--l. 2--><p class="noindent" ><a 
 id="tailOptTestHarness.html"></a> 
</body></html> 
