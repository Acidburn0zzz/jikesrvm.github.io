<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>ReferenceMaps (Jikes RVM API)</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ReferenceMaps (Jikes RVM API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10,"i22":10,"i23":10,"i24":10,"i25":10,"i26":10,"i27":10,"i28":10,"i29":10,"i30":10,"i31":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ReferenceMaps.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jikesrvm/compilers/baseline/PendingRETInfo.html" title="class in org.jikesrvm.compilers.baseline"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.MergeOperation.html" title="enum in org.jikesrvm.compilers.baseline"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jikesrvm/compilers/baseline/ReferenceMaps.html" target="_top">Frames</a></li>
<li><a href="ReferenceMaps.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.jikesrvm.compilers.baseline</div>
<h2 title="Class ReferenceMaps" class="title">Class ReferenceMaps</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.jikesrvm.compilers.baseline.ReferenceMaps</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public final class <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.31">ReferenceMaps</a>
extends <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">class that provides stack (and local var) map for a baseline compiled method
 GC uses the methods provided here</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.MergeOperation.html" title="enum in org.jikesrvm.compilers.baseline">ReferenceMaps.MergeOperation</a></span></code>
<div class="block">Kinds of merge operation when merging delta maps into table maps</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#BITS_PER_MAP_ELEMENT">BITS_PER_MAP_ELEMENT</a></span></code>
<div class="block">Number of bits in each map element</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#bitsPerMap">bitsPerMap</a></span></code>
<div class="block">Number of bits in each map</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) short[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#byteToBlockMap">byteToBlockMap</a></span></code>
<div class="block">identify which block a byte is part of</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#JSR_INDEX_MASK">JSR_INDEX_MASK</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#JSR_MASK">JSR_MASK</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../org/jikesrvm/compilers/baseline/JSRInfo.html" title="class in org.jikesrvm.compilers.baseline">JSRInfo</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#jsrInfo">jsrInfo</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../../../org/jikesrvm/scheduler/SpinLock.html" title="class in org.jikesrvm.scheduler">SpinLock</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#jsrLock">jsrLock</a></span></code>
<div class="block">Serializes JSR processing</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#mapCount">mapCount</a></span></code>
<div class="block">Number of maps</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#MCSites">MCSites</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#NOMORE">NOMORE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#referenceMaps">referenceMaps</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#STARTINDEX">STARTINDEX</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#ReferenceMaps-org.jikesrvm.compilers.baseline.BaselineCompiledMethod-int:A-byte:A-">ReferenceMaps</a></span>(<a href="../../../../org/jikesrvm/compilers/baseline/BaselineCompiledMethod.html" title="class in org.jikesrvm.compilers.baseline">BaselineCompiledMethod</a>&nbsp;cm,
             int[]&nbsp;stackHeights,
             byte[]&nbsp;localTypes)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#addUnusualMap-org.jikesrvm.compilers.baseline.UnusualMaps-">addUnusualMap</a></span>(<a href="../../../../org/jikesrvm/compilers/baseline/UnusualMaps.html" title="class in org.jikesrvm.compilers.baseline">UnusualMaps</a>&nbsp;jsrSiteMap)</code>
<div class="block">Add an UnusualMap to the array of unusual maps, expand the array
 and referencemap array if necessary</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#bytesPerMap--">bytesPerMap</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#cleanupPointers--">cleanupPointers</a></span>()</code>
<div class="block">This routine is used to clean out the MethodMap of structures that
 were allocated from temporary storage.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private <a href="../../../../org/jikesrvm/compilers/baseline/UnusualMaps.html" title="class in org.jikesrvm.compilers.baseline">UnusualMaps</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#combineDeltaMaps-int-">combineDeltaMaps</a></span>(int&nbsp;jsrUnusualMapid)</code>
<div class="block">Merges unusual maps (occurs in nested jsr conditions) by merging each nested
 delta map ( as represented by the jsrMapid of the location site) into the
 jsrInfo.extraUnusualMap where the deltas are accumulated</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#convertMapElement-byte:A-int-int-byte-">convertMapElement</a></span>(byte[]&nbsp;curBBMap,
                 int&nbsp;offset,
                 int&nbsp;len,
                 byte&nbsp;reftype)</code>
<div class="block">Convert a portion of an array word of Bytes into a bitmap of references.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#copyBitMap-int-int-">copyBitMap</a></span>(int&nbsp;extramapindex,
          int&nbsp;index)</code>
<div class="block">Copies a bit map into the extra unusualmap.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#finalMergeMaps-int-org.jikesrvm.compilers.baseline.UnusualMaps-">finalMergeMaps</a></span>(int&nbsp;jsrBaseMapIndex,
              <a href="../../../../org/jikesrvm/compilers/baseline/UnusualMaps.html" title="class in org.jikesrvm.compilers.baseline">UnusualMaps</a>&nbsp;deltaMap)</code>
<div class="block">This method will merge the jsr invoker's base map with changes
 due to *all* nested jsr subroutines.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#findUnusualMap-int-">findUnusualMap</a></span>(int&nbsp;mapid)</code>
<div class="block">Finds an unsual map with an index greater than 127.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#getNextJSRAddressIndex-org.vmmagic.unboxed.Offset-org.jikesrvm.classloader.NormalMethod-">getNextJSRAddressIndex</a></span>(<a href="../../../../org/vmmagic/unboxed/Offset.html" title="class in org.vmmagic.unboxed">Offset</a>&nbsp;nextMachineCodeOffset,
                      <a href="../../../../org/jikesrvm/classloader/NormalMethod.html" title="class in org.jikesrvm.classloader">NormalMethod</a>&nbsp;m)</code>&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#getNextJSRRefIndex-int-">getNextJSRRefIndex</a></span>(int&nbsp;index)</code>
<div class="block">Given an offset in the jsr reference map,
 return the offset where the next returnAddress can be found.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#getNextJSRReturnAddrIndex-int-">getNextJSRReturnAddrIndex</a></span>(int&nbsp;index)</code>
<div class="block">Given an offset in the jsr returnAddress map,
   return the offset where the next returnAddress can be found.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#getNextMapElement--">getNextMapElement</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#getNextRefIndex-int-int-">getNextRefIndex</a></span>(int&nbsp;index,
               int&nbsp;siteindex)</code>&nbsp;</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#getStackDepth-int-">getStackDepth</a></span>(int&nbsp;mapid)</code>&nbsp;</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#isLocalRefType-org.jikesrvm.classloader.RVMMethod-org.vmmagic.unboxed.Offset-int-">isLocalRefType</a></span>(<a href="../../../../org/jikesrvm/classloader/RVMMethod.html" title="class in org.jikesrvm.classloader">RVMMethod</a>&nbsp;method,
              <a href="../../../../org/vmmagic/unboxed/Offset.html" title="class in org.vmmagic.unboxed">Offset</a>&nbsp;mcoff,
              int&nbsp;lidx)</code>
<div class="block">Query if a local variable has a reference type value</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#locateGCPoint-org.vmmagic.unboxed.Offset-org.jikesrvm.classloader.RVMMethod-">locateGCPoint</a></span>(<a href="../../../../org/vmmagic/unboxed/Offset.html" title="class in org.vmmagic.unboxed">Offset</a>&nbsp;machCodeOffset,
             <a href="../../../../org/jikesrvm/classloader/RVMMethod.html" title="class in org.jikesrvm.classloader">RVMMethod</a>&nbsp;method)</code>
<div class="block">Given a machine code instruction offset, return an index to
 identify the stack map closest to the offset ( but not beyond).</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#mergeMap-int-int-org.jikesrvm.compilers.baseline.ReferenceMaps.MergeOperation-">mergeMap</a></span>(int&nbsp;targetindex,
        int&nbsp;deltaindex,
        <a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.MergeOperation.html" title="enum in org.jikesrvm.compilers.baseline">ReferenceMaps.MergeOperation</a>&nbsp;Op)</code>
<div class="block">Merges a delta map into a target map.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#recordingComplete--">recordingComplete</a></span>()</code>
<div class="block">Called when all the recording for this map is complete.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#recordJSRSubroutineMap-int-byte:A-int-int-boolean-">recordJSRSubroutineMap</a></span>(int&nbsp;byteindex,
                      byte[]&nbsp;currReferenceMap,
                      int&nbsp;BBLastPtr,
                      int&nbsp;returnAddrIndex,
                      boolean&nbsp;replacemap)</code>
<div class="block">Record a map for a point within a JSR Subroutine.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#recordStkMap-int-byte:A-int-boolean-">recordStkMap</a></span>(int&nbsp;byteindex,
            byte[]&nbsp;byteMap,
            int&nbsp;BBLastPtr,
            boolean&nbsp;replacemap)</code>
<div class="block">Given the information about a GC point, record the information in the proper tables.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#scanByte-int-int-int-byte:A-">scanByte</a></span>(int&nbsp;bitnum,
        int&nbsp;bytenum,
        int&nbsp;toscan,
        byte[]&nbsp;map)</code>
<div class="block">Scans for a reference in a byte.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#scanByteArray-byte:A-int-byte-int-boolean-">scanByteArray</a></span>(byte[]&nbsp;byteMap,
             int&nbsp;BBLastPtr,
             byte&nbsp;refType,
             int&nbsp;mapslot,
             boolean&nbsp;skipOneBit)</code>
<div class="block">Scans the byte array to look for the type of information that was requested.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#scanForNextRef-int-int-int-byte:A-">scanForNextRef</a></span>(int&nbsp;bitnum,
              int&nbsp;wordnum,
              int&nbsp;remaining,
              byte[]&nbsp;map)</code>
<div class="block">Scans the map for the next reference.</div>
</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#setupJSRSubroutineMap-int-">setupJSRSubroutineMap</a></span>(int&nbsp;mapid)</code>
<div class="block">Setup a map  within a JSR Subroutine.</div>
</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#showAMap-int-">showAMap</a></span>(int&nbsp;MCSiteIndex)</code>
<div class="block">Show the basic information for a single map.</div>
</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#showInfo--">showInfo</a></span>()</code>
<div class="block">Shows the basic information for each of the maps.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#showOffsets--">showOffsets</a></span>()</code>
<div class="block">Show the offsets for all the maps.</div>
</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#showReferenceMapStatistics-org.jikesrvm.classloader.RVMMethod-">showReferenceMapStatistics</a></span>(<a href="../../../../org/jikesrvm/classloader/RVMMethod.html" title="class in org.jikesrvm.classloader">RVMMethod</a>&nbsp;method)</code>&nbsp;</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#size--">size</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i29" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#startNewMaps-int-int-int-">startNewMaps</a></span>(int&nbsp;gcPointCount,
            int&nbsp;jsrCount,
            int&nbsp;parameterWords)</code>&nbsp;</td>
</tr>
<tr id="i30" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#translateByte2Machine-int:A-">translateByte2Machine</a></span>(int[]&nbsp;b2m)</code>
<div class="block">After code is generated, translate the bytecode indices
 recorded in MCSites array into real machine code offsets.</div>
</td>
</tr>
<tr id="i31" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#unusualMapcopy-org.jikesrvm.compilers.baseline.UnusualMaps-">unusualMapcopy</a></span>(<a href="../../../../org/jikesrvm/compilers/baseline/UnusualMaps.html" title="class in org.jikesrvm.compilers.baseline">UnusualMaps</a>&nbsp;from)</code>
<div class="block">Makes a deep copy of <code>from</code> into <code>jsrInfo.extraUnusualMap</code></div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="JSR_MASK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>JSR_MASK</h4>
<pre>public static final&nbsp;byte <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.33">JSR_MASK</a></pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.jikesrvm.compilers.baseline.ReferenceMaps.JSR_MASK">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="JSR_INDEX_MASK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>JSR_INDEX_MASK</h4>
<pre>public static final&nbsp;byte <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.34">JSR_INDEX_MASK</a></pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.jikesrvm.compilers.baseline.ReferenceMaps.JSR_INDEX_MASK">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="STARTINDEX">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>STARTINDEX</h4>
<pre>public static final&nbsp;int <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.36">STARTINDEX</a></pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.jikesrvm.compilers.baseline.ReferenceMaps.STARTINDEX">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="NOMORE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NOMORE</h4>
<pre>public static final&nbsp;int <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.37">NOMORE</a></pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.jikesrvm.compilers.baseline.ReferenceMaps.NOMORE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="jsrLock">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>jsrLock</h4>
<pre>public static final&nbsp;<a href="../../../../org/jikesrvm/scheduler/SpinLock.html" title="class in org.jikesrvm.scheduler">SpinLock</a> <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.44">jsrLock</a></pre>
<div class="block">Serializes JSR processing</div>
</li>
</ul>
<a name="BITS_PER_MAP_ELEMENT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BITS_PER_MAP_ELEMENT</h4>
<pre>private static final&nbsp;int <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.47">BITS_PER_MAP_ELEMENT</a></pre>
<div class="block">Number of bits in each map element</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.jikesrvm.compilers.baseline.ReferenceMaps.BITS_PER_MAP_ELEMENT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="referenceMaps">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>referenceMaps</h4>
<pre>private&nbsp;byte[] <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.48">referenceMaps</a></pre>
</li>
</ul>
<a name="MCSites">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MCSites</h4>
<pre>private&nbsp;int[] <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.49">MCSites</a></pre>
</li>
</ul>
<a name="bitsPerMap">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bitsPerMap</h4>
<pre>private final&nbsp;int <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.51">bitsPerMap</a></pre>
<div class="block">Number of bits in each map</div>
</li>
</ul>
<a name="mapCount">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mapCount</h4>
<pre>private&nbsp;int <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.53">mapCount</a></pre>
<div class="block">Number of maps</div>
</li>
</ul>
<a name="jsrInfo">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>jsrInfo</h4>
<pre>private&nbsp;<a href="../../../../org/jikesrvm/compilers/baseline/JSRInfo.html" title="class in org.jikesrvm.compilers.baseline">JSRInfo</a> <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.54">jsrInfo</a></pre>
</li>
</ul>
<a name="byteToBlockMap">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>byteToBlockMap</h4>
<pre>final&nbsp;short[] <a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.56">byteToBlockMap</a></pre>
<div class="block">identify which block a byte is part of</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ReferenceMaps-org.jikesrvm.compilers.baseline.BaselineCompiledMethod-int:A-byte:A-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ReferenceMaps</h4>
<pre><a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.65">ReferenceMaps</a>(<a href="../../../../org/jikesrvm/compilers/baseline/BaselineCompiledMethod.html" title="class in org.jikesrvm.compilers.baseline">BaselineCompiledMethod</a>&nbsp;cm,
              int[]&nbsp;stackHeights,
              byte[]&nbsp;localTypes)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="bytesPerMap--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bytesPerMap</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.61">bytesPerMap</a>()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>size of individual maps</dd>
</dl>
</li>
</ul>
<a name="locateGCPoint-org.vmmagic.unboxed.Offset-org.jikesrvm.classloader.RVMMethod-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>locateGCPoint</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.116">locateGCPoint</a>(<a href="../../../../org/vmmagic/unboxed/Offset.html" title="class in org.vmmagic.unboxed">Offset</a>&nbsp;machCodeOffset,
                         <a href="../../../../org/jikesrvm/classloader/RVMMethod.html" title="class in org.jikesrvm.classloader">RVMMethod</a>&nbsp;method)</pre>
<div class="block">Given a machine code instruction offset, return an index to
 identify the stack map closest to the offset ( but not beyond).<p>

 Usage note: "machCodeOffset" must point to the instruction *following*
              the actual instruction
 whose stack map is sought. This allows us to properly handle the case where
 the only address we have to work with is a return address (i.e. from a stackframe)
 or an exception address (i.e. from a null pointer dereference, array bounds check,
 or divide by zero) on a machine architecture with variable length instructions.
 In such situations we'd have no idea how far to back up the instruction pointer
 to point to the "call site" or "exception site".<p>

 If the located site is within the scope of a jsr subroutine
  the index value returned is a negative number.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>machCodeOffset</code> - offset into machine code (see above for constraints)</dd>
<dd><code>method</code> - the method that contains the gc point</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>index of the appropriate stack map</dd>
</dl>
</li>
</ul>
<a name="getNextRefIndex-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextRefIndex</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.202">getNextRefIndex</a>(int&nbsp;index,
                           int&nbsp;siteindex)</pre>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>index</code> - offset in the reference stack frame,</dd>
<dd><code>siteindex</code> - index that indicates the callsite (siteindex),</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>return the offset where the next reference can be found,
  <a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#NOMORE"><code>NOMORE</code></a> when no more pointers can be found</dd>
</dl>
</li>
</ul>
<a name="getNextJSRRefIndex-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextJSRRefIndex</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.270">getNextJSRRefIndex</a>(int&nbsp;index)</pre>
<div class="block">Given an offset in the jsr reference map,
 return the offset where the next returnAddress can be found.<p>

  NOTE: There is only one JSR map for the entire method because it has to
       be constructed at GC time and would normally require additional
       storage.
 <p>
       To avoid this, the space for one map is pre-allocated and the map
       is built in that space.  When multiple threads exist and if GC runs
       in multiple threads concurrently, then the MethodMap must be locked
       when a JSR map is being scanned.  This should be a low probability
       event.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>index</code> - offset in the JSR reference map,</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The offset where the next reference can be found or
  <code>NOMORE</code> when no more pointers can be found</dd>
</dl>
</li>
</ul>
<a name="getNextJSRReturnAddrIndex-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextJSRReturnAddrIndex</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.330">getNextJSRReturnAddrIndex</a>(int&nbsp;index)</pre>
<div class="block">Given an offset in the jsr returnAddress map,
   return the offset where the next returnAddress can be found.<p>

 NOTE: there is only one jsr returnAddress map for the entire method because it has to be
       be constructed a GC time and would normally require additional storage.
       To avoid this, the space for one map is pre-allocated and the map
       is built in that space. When multiple threads exist and if GC runs
       in multiple threads concurrently, then the MethodMap must be locked
       when a jsr map is being scanned.
       This should be a low probability event.<p>

 NOTE: return addresses are handled separately from references because they point
       inside an object ( internal pointers)</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>index</code> - offset in the JSR returnAddress map,</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The offset where the next reference can be found or
  <code>NOMORE</code> when no more pointers can be found</dd>
</dl>
</li>
</ul>
<a name="getStackDepth-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStackDepth</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.385">getStackDepth</a>(int&nbsp;mapid)</pre>
</li>
</ul>
<a name="size--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>size</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.390">size</a>()</pre>
</li>
</ul>
<a name="startNewMaps-int-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startNewMaps</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.401">startNewMaps</a>(int&nbsp;gcPointCount,
                         int&nbsp;jsrCount,
                         int&nbsp;parameterWords)</pre>
</li>
</ul>
<a name="recordStkMap-int-byte:A-int-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordStkMap</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.454">recordStkMap</a>(int&nbsp;byteindex,
                         byte[]&nbsp;byteMap,
                         int&nbsp;BBLastPtr,
                         boolean&nbsp;replacemap)</pre>
<div class="block">Given the information about a GC point, record the information in the proper tables.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>byteindex</code> - the index in the bytecode of this site</dd>
<dd><code>byteMap</code> - a byte array that describes the contents of the local variables and the java stack</dd>
<dd><code>BBLastPtr</code> - the last offset of a byte that contains information about the map</dd>
<dd><code>replacemap</code> - whether this map is a replacement for a currently
        existing map</dd>
</dl>
</li>
</ul>
<a name="recordJSRSubroutineMap-int-byte:A-int-int-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordJSRSubroutineMap</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.582">recordJSRSubroutineMap</a>(int&nbsp;byteindex,
                                   byte[]&nbsp;currReferenceMap,
                                   int&nbsp;BBLastPtr,
                                   int&nbsp;returnAddrIndex,
                                   boolean&nbsp;replacemap)</pre>
<div class="block">Record a map for a point within a JSR Subroutine. This requires setting up one
 of the unusual maps.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>byteindex</code> - index into the byte code array of the point for the map</dd>
<dd><code>currReferenceMap</code> - map of references and return addresses that were set
                          within the JSR Subroutine</dd>
<dd><code>BBLastPtr</code> - map runs from -1  to BBLastPtr inclusively</dd>
<dd><code>returnAddrIndex</code> - Index in the stack where the return address
                            for the jsr routine (in which this gcpoint is located)
                            can be found</dd>
<dd><code>replacemap</code> - <code>false</code> if this is the first time this map point has been
                          recorded.</dd>
</dl>
</li>
</ul>
<a name="addUnusualMap-org.jikesrvm.compilers.baseline.UnusualMaps-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addUnusualMap</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.736">addUnusualMap</a>(<a href="../../../../org/jikesrvm/compilers/baseline/UnusualMaps.html" title="class in org.jikesrvm.compilers.baseline">UnusualMaps</a>&nbsp;jsrSiteMap)</pre>
<div class="block">Add an UnusualMap to the array of unusual maps, expand the array
 and referencemap array if necessary</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>jsrSiteMap</code> - unusualMap to be added to array</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>number of the added map in the array</dd>
</dl>
</li>
</ul>
<a name="setupJSRSubroutineMap-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setupJSRSubroutineMap</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.791">setupJSRSubroutineMap</a>(int&nbsp;mapid)</pre>
<div class="block">Setup a map  within a JSR Subroutine. This requires using up one
 of the unusual maps. This routine is called when the caller gets a
 negative mapindex value return from <a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#locateGCPoint-org.vmmagic.unboxed.Offset-org.jikesrvm.classloader.RVMMethod-"><code>locateGCPoint(org.vmmagic.unboxed.Offset, org.jikesrvm.classloader.RVMMethod)</code></a>. This routine
 searches the map tables and uses its stack frameAddress input to build
 reference and returnAddress maps. The caller uses the getNext...
 routines to scan these maps for offsets in the frame of the
 related references.<p>

 Steps for this routine:
 <ol>
   <li>use the mapid to get index of the Unusual Map
   <li>from the unusual map and the frame - get the location of the jsr invoker
   <li>from the invoker address and the code base address - get the machine code offset
   from the machine code offset locate the map for that instruction
   <li>if the invoker was itself in a jsr- merge the delta maps of each jsr and
     compute the new total delta maps
   <li>else the invoker was not already in a jsr merge the unusual map differences
     with the invoker map
 </ol></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mapid</code> - Index of map of instruction where map is required
                          ( this value was returned by locateGCpoint)</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the index of the JSR invoker</dd>
</dl>
</li>
</ul>
<a name="getNextJSRAddressIndex-org.vmmagic.unboxed.Offset-org.jikesrvm.classloader.NormalMethod-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextJSRAddressIndex</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.826">getNextJSRAddressIndex</a>(<a href="../../../../org/vmmagic/unboxed/Offset.html" title="class in org.vmmagic.unboxed">Offset</a>&nbsp;nextMachineCodeOffset,
                                  <a href="../../../../org/jikesrvm/classloader/NormalMethod.html" title="class in org.jikesrvm.classloader">NormalMethod</a>&nbsp;m)</pre>
</li>
</ul>
<a name="recordingComplete--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordingComplete</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.884">recordingComplete</a>()</pre>
<div class="block">Called when all the recording for this map is complete. Can now
 sort or perform other cleanups</div>
</li>
</ul>
<a name="translateByte2Machine-int:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>translateByte2Machine</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.893">translateByte2Machine</a>(int[]&nbsp;b2m)</pre>
<div class="block">After code is generated, translate the bytecode indices
 recorded in MCSites array into real machine code offsets.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>b2m</code> - map of byte code index to machine code offsets</dd>
</dl>
</li>
</ul>
<a name="convertMapElement-byte:A-int-int-byte-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>convertMapElement</h4>
<pre>private&nbsp;byte&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.908">convertMapElement</a>(byte[]&nbsp;curBBMap,
                               int&nbsp;offset,
                               int&nbsp;len,
                               byte&nbsp;reftype)</pre>
<div class="block">Convert a portion of an array word of Bytes into a bitmap of references.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>curBBMap</code> - a byte array that describes the contents of the local variables and the java stack</dd>
<dd><code>offset</code> - a starting offset in the array</dd>
<dd><code>len</code> - length of the scan, max is <a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.html#BITS_PER_MAP_ELEMENT"><code>BITS_PER_MAP_ELEMENT</code></a></dd>
<dd><code>reftype</code> - the type of byte to scan for</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a bitword</dd>
</dl>
</li>
</ul>
<a name="getNextMapElement--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextMapElement</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.924">getNextMapElement</a>()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>next free word in referencemaps for GC call sites</dd>
</dl>
</li>
</ul>
<a name="scanForNextRef-int-int-int-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>scanForNextRef</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.971">scanForNextRef</a>(int&nbsp;bitnum,
                           int&nbsp;wordnum,
                           int&nbsp;remaining,
                           byte[]&nbsp;map)</pre>
<div class="block">Scans the map for the next reference.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bitnum</code> - starting bitnumber in a map (inclusive)</dd>
<dd><code>wordnum</code> - index of the corresponding byte,</dd>
<dd><code>remaining</code> - remaining number of bits in the map,</dd>
<dd><code>map</code> - map to search</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>TODO document me</dd>
</dl>
</li>
</ul>
<a name="scanByte-int-int-int-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>scanByte</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1022">scanByte</a>(int&nbsp;bitnum,
                     int&nbsp;bytenum,
                     int&nbsp;toscan,
                     byte[]&nbsp;map)</pre>
<div class="block">Scans for a reference in a byte.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bitnum</code> - bitnumber in the map</dd>
<dd><code>bytenum</code> - index of the corresponding map byte</dd>
<dd><code>toscan</code> - the remaining number of bits in the byte,</dd>
<dd><code>map</code> - the map</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>next ref in the byte or zero if not found</dd>
</dl>
</li>
</ul>
<a name="scanByteArray-byte:A-int-byte-int-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>scanByteArray</h4>
<pre>int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1066">scanByteArray</a>(byte[]&nbsp;byteMap,
                  int&nbsp;BBLastPtr,
                  byte&nbsp;refType,
                  int&nbsp;mapslot,
                  boolean&nbsp;skipOneBit)</pre>
<div class="block">Scans the byte array to look for the type of information that was requested. Builds a
 bit array in the stack maps with the information.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>byteMap</code> - bytearray where each byte describes the corresponding word on a stack</dd>
<dd><code>BBLastPtr</code> - length of the byte array</dd>
<dd><code>refType</code> - type of information that is to be scanned</dd>
<dd><code>mapslot</code> - slot where map should be stored, 0 for next free slot</dd>
<dd><code>skipOneBit</code> - should a bit in the bitarray be skipped? Necessary for setRef and
 setNonRef maps so so they are properly merged with jsr base maps.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>index of the map in the reference map</dd>
</dl>
</li>
</ul>
<a name="unusualMapcopy-org.jikesrvm.compilers.baseline.UnusualMaps-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unusualMapcopy</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1109">unusualMapcopy</a>(<a href="../../../../org/jikesrvm/compilers/baseline/UnusualMaps.html" title="class in org.jikesrvm.compilers.baseline">UnusualMaps</a>&nbsp;from)</pre>
<div class="block">Makes a deep copy of <code>from</code> into <code>jsrInfo.extraUnusualMap</code></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>from</code> - the map to copy from</dd>
</dl>
</li>
</ul>
<a name="copyBitMap-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>copyBitMap</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1121">copyBitMap</a>(int&nbsp;extramapindex,
                        int&nbsp;index)</pre>
<div class="block">Copies a bit map into the extra unusualmap.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>extramapindex</code> - the index of the map in the jsrInfo.extraUnusualMap ie the "to" map</dd>
<dd><code>index</code> - he index of the map to copy ie the "from" map</dd>
</dl>
</li>
</ul>
<a name="combineDeltaMaps-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>combineDeltaMaps</h4>
<pre>private&nbsp;<a href="../../../../org/jikesrvm/compilers/baseline/UnusualMaps.html" title="class in org.jikesrvm.compilers.baseline">UnusualMaps</a>&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1157">combineDeltaMaps</a>(int&nbsp;jsrUnusualMapid)</pre>
<div class="block">Merges unusual maps (occurs in nested jsr conditions) by merging each nested
 delta map ( as represented by the jsrMapid of the location site) into the
 jsrInfo.extraUnusualMap where the deltas are accumulated</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>jsrUnusualMapid</code> - the delta map's id</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>merged map</dd>
</dl>
</li>
</ul>
<a name="mergeMap-int-int-org.jikesrvm.compilers.baseline.ReferenceMaps.MergeOperation-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mergeMap</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1267">mergeMap</a>(int&nbsp;targetindex,
                      int&nbsp;deltaindex,
                      <a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.MergeOperation.html" title="enum in org.jikesrvm.compilers.baseline">ReferenceMaps.MergeOperation</a>&nbsp;Op)</pre>
<div class="block">Merges a delta map into a target map.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>targetindex</code> - the delta map's index in the reference map table</dd>
<dd><code>deltaindex</code> - the target map's index in the reference map tbale</dd>
<dd><code>Op</code> - the merge operation to use</dd>
</dl>
</li>
</ul>
<a name="finalMergeMaps-int-org.jikesrvm.compilers.baseline.UnusualMaps-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>finalMergeMaps</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1305">finalMergeMaps</a>(int&nbsp;jsrBaseMapIndex,
                            <a href="../../../../org/jikesrvm/compilers/baseline/UnusualMaps.html" title="class in org.jikesrvm.compilers.baseline">UnusualMaps</a>&nbsp;deltaMap)</pre>
<div class="block">This method will merge the jsr invoker's base map with changes
 due to *all* nested jsr subroutines.<p>

 The nested jsr subroutine maps were merged into a single delta
 map prior to the calling of this method.  We therefore know that
 the base map can never be due to a subroutine (since all
 subroutines have been merged), and therefore that there are no
 return address maps due to the invoker (since return addresses
 are only due to the subroutine maps).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>jsrBaseMapIndex</code> - The map index for the invoker</dd>
<dd><code>deltaMap</code> - The map for the invoked subroutine/s (all nested
 subroutine maps are guaranteed to have been combined prior to
 calling this)</dd>
</dl>
</li>
</ul>
<a name="cleanupPointers--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cleanupPointers</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1393">cleanupPointers</a>()</pre>
<div class="block">This routine is used to clean out the MethodMap of structures that
 were allocated from temporary storage. Temporary storage is freed up
  between stack frames as the GC scans the stack.</div>
</li>
</ul>
<a name="findUnusualMap-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findUnusualMap</h4>
<pre>int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1411">findUnusualMap</a>(int&nbsp;mapid)</pre>
<div class="block">Finds an unsual map with an index greater than 127. It returns the index
 by doing a sequential scan and looking for the mapid in the normal map
 directory.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mapid</code> - the map's id</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the map's index</dd>
</dl>
</li>
</ul>
<a name="showInfo--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showInfo</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1432">showInfo</a>()</pre>
<div class="block">Shows the basic information for each of the maps.
 This is for testing use.</div>
</li>
</ul>
<a name="showAMap-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showAMap</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1460">showAMap</a>(int&nbsp;MCSiteIndex)</pre>
<div class="block">Show the basic information for a single map. This is for testing
 use.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>MCSiteIndex</code> - index of the machine code site</dd>
</dl>
</li>
</ul>
<a name="showOffsets--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showOffsets</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1473">showOffsets</a>()</pre>
<div class="block">Show the offsets for all the maps. This is for test use.</div>
</li>
</ul>
<a name="showReferenceMapStatistics-org.jikesrvm.classloader.RVMMethod-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>showReferenceMapStatistics</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1500">showReferenceMapStatistics</a>(<a href="../../../../org/jikesrvm/classloader/RVMMethod.html" title="class in org.jikesrvm.classloader">RVMMethod</a>&nbsp;method)</pre>
</li>
</ul>
<a name="isLocalRefType-org.jikesrvm.classloader.RVMMethod-org.vmmagic.unboxed.Offset-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>isLocalRefType</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/jikesrvm/compilers/baseline/ReferenceMaps.html#line.1551">isLocalRefType</a>(<a href="../../../../org/jikesrvm/classloader/RVMMethod.html" title="class in org.jikesrvm.classloader">RVMMethod</a>&nbsp;method,
                              <a href="../../../../org/vmmagic/unboxed/Offset.html" title="class in org.vmmagic.unboxed">Offset</a>&nbsp;mcoff,
                              int&nbsp;lidx)</pre>
<div class="block">Query if a local variable has a reference type value</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>method</code> - The method we're asking about.</dd>
<dd><code>mcoff</code> - The machine code offset of the instruction *following* the
               actual instruction.</dd>
<dd><code>lidx</code> - the local index</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code>, if it is a reference type. <code>false</code>, otherwise</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ReferenceMaps.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/jikesrvm/compilers/baseline/PendingRETInfo.html" title="class in org.jikesrvm.compilers.baseline"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../org/jikesrvm/compilers/baseline/ReferenceMaps.MergeOperation.html" title="enum in org.jikesrvm.compilers.baseline"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jikesrvm/compilers/baseline/ReferenceMaps.html" target="_top">Frames</a></li>
<li><a href="ReferenceMaps.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
